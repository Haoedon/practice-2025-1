## Реализация уязвимостей
___
1. **SQL injection vulnerability in WHERE clause**.
> Для реализации этой уязвимости я использовал платформу Portswigger.

**Реализация:**

 - Откроем учебный веб-сайт.
    ![img.png](images/img_2.png)
 > Чтобы решить лабораторную работу, выполним атаку с помощью SQL-инъекции, в результате которой приложение отобразит один или несколько скрытых продуктов.
 - Найдём поле ввода, которое используется в SQL-запросе с условием WHERE (например, поле для поиска или фильтрации данных).

 - Введём сложный SQL-код, который извлекает скрытые данные, например: '+OR+1=1--.
    ![img.png](images/img_3.png)

 - Отправим запрос и убедимся, что скрытые товары извлекаются из базы данных.
    ![img.png](images/img_4.png)

2. **Blind OS command injection with time delays**.

> Для реализации этой уязвимости я использовал платформу Portswigger.
- Откроем учебный веб-сайт.
![img.png](images/img_5.png)
> Приложение выполняет команду оболочки, содержащую данные, предоставленные пользователем. Результат выполнения команды не возвращается в ответ. Чтобы решить лабораторную работу, воспользуемся уязвимостью, связанной с внедрением команд операционной системы вслепую, чтобы вызвать 10-секундную задержку.
- Запустим программу Burp Suite для перехвата трафика.

![img.png](images/img_6.png)

- Запустим перехват и отправим обратную связь. Перехватим POST запрос.

![img.png](images/img_7.png)

- Отправим этот запрос в Repeater и добавим полезную нагрузку в параметр CSRF. 
Параметр csrf будет принимать такое значение:

```commandline
csrf=KNJ1uEpRvh3OOCkI79jXUhKCU8csOMpk&name=test&email=test%40gmail.com%26+sleep+10+%23&subject=test&message=test
```

![img.png](images/img_8.png)

- Отправим изменённый запрос с 10 секундной задержкой.

![img.png](images/img_9.png)

Ответ получаем через 10 секунд, что говорит нам об удачной атаке.

![img.png](images/img_10.png)

3. **Blind OS command injection with output redirection**.
> Для реализации этой уязвимости я использовал платформу Portswigger.
- Откроем учебный веб-сайт.
![img.png](images/img_11.png)
> Приложение выполняет команду оболочки, содержащую данные, предоставленные пользователем. Результат выполнения команды не возвращается в ответе. Однако мы можем использовать перенаправление вывода для записи результатов выполнения команды. Доступная для записи папка находится по адресу:
/var/www/images/ 

> Приложение загружает изображения для каталога товаров из этого каталога. Мы можем перенаправить выходные данные введенной команды в файл в этой папке, а затем использовать URL-адрес загрузки изображений для получения содержимого файла.

- Проверив все возможные поля ввода при помощи полезной нагрузки `& sleep 10 #`, мы определили, что параметр email уязвим для внедрения команды ОС.

```commandline
csrf=uuPKLGvGmZA8aAc9Buyo4kh5BTaBWVlk&name=test&email=qqq%40gmail.com+%26+sleep+10+%23&subject=test&message=test
```

![img.png](images/img_12.png)

- Теперь попытаемся создать файл в месте, к которому мы можем получить доступ через веб-приложение, и сохранить вывод whoami в этот файл.
Мы запишем вывод whoami в /var/www/images/output.txt

![img.png](images/img_13.png)

- Откроем только что созданный файл.

![img.png](images/img_14.png)

У нас получилось выполнить команду whoami и получите выходные данные в созданной на сервере директории.

![img.png](images/img_15.png)

4. **SSRF with filter bypass via open redirection vulnerability**
> Для реализации этой уязвимости я использовал платформу Portswigger.

- Откроем учебный веб-сайт.
![img.png](images/img_16.png)
> Чтобы решить лабораторную задачу, изменим URL-адрес stock check для доступа к интерфейсу администратора по адресу http://192.168.0.12:8080/admin и удалим пользователя carlos.

> Для stock checker был ограничен доступ только к локальному приложению, поэтому сначала нам нужно будет найти открытый редирект, влияющий на приложение.

- Перейдём по карточке любого товара, начнём перехват трафика и нажмём на кнопку next product.

Здесь стоит обратить внимание на указание на следующий продукт.

![img.png](images/img_17.png)

Параметр path помещен в заголовок ответа на перенаправление, что приводит к открытому перенаправлению.
- Теперь рассмотрим `POST /product/stock`

Создадим URL-адрес, который использует уязвимость открытого перенаправления и перенаправляет на интерфейс администратора. Введём его в параметр stockApi в программе проверки запасов.

![img.png](images/img_18.png)

- Отправляем запрос. Открывается админ панель.

![img.png](images/img_19.png)

- Попробуем удалить нужного пользователя. Для этого изменим путь, чтобы удалить целевого пользователя.

- ![img.png](images/img_20.png)

- Пользователь успешно удалён.

![img.png](images/img_21.png)

![img.png](images/img_22.png)

5. **XXE Injection**
> Для реализации этой уязвимости я использовал платформу Portswigger.

- Откроем учебный веб-сайт.
![img.png](images/img_23.png)
> Для решения лабораторной работы, введём инструкцию XInclude для извлечения содержимого файла /etc/passwd.

- Перейдём на карточку любого товара и начнём перехват трафика. Нажмём на кнопку `check stock`.
Рассмотрим `POST /product/stock`

![img.png](images/img_24.png)

- Выполним атаку XInclude. Обратимся к пространству имен XInclude и укажем путь к файлу `/etc/passwd` в параметре `productId`.

![img.png](images/img_25.png)

- Извлекаем содержимое файла.

![img.png](images/img_26.png)

![img.png](images/img_27.png)




