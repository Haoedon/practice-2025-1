## Введение: актуальность веб-уязвимостей
___
**Современные сайты** – это сложные системы, которые обрабатывают огромное количество данных. Логины, пароли, платёжная информация, личные переписки, фотографии – всё хранится на серверах, а пользователи, как правило, не задумываются, насколько безопасно доверять свои данные конкретному ресурсу. Злоумышленники используют все методы для получения несанкционированного доступа, и наиболее уязвимые точки могут быть реально взломаны при отсутствии базовой защиты.

## Виды основных уязвимостей веб-приложений
___

- **SQL-инъекция (SQL Injection)**
  - Описание: Внедрение злонамеренного SQL-кода через пользовательский ввод, который некорректно обрабатывается приложением.
- **Командная инъекция (Command Injection)**
  - Описание: Когда злоумышленник может выполнить системные команды через уязвимое веб-приложение, которое взаимодействует с БД через shell-команды.
- **SSRF (Server-Side Request Forgery)**
  - Описание: Приложение делает запросы от своего имени, и атакующий может заставить его обратиться к внутренним сервисам (например, к БД).
- **XML External Entity**
  - Описание: Если приложение использует XML для взаимодействия с БД (например, SOAP-запросы), можно внедрить вредоносные сущности.

## SQL-инъекции
___

**Суть уязвимости**: в полях ввода (например, форма логина и пароля, поле поиска, комментариев и так далее) пользователь вводит данные, а сервер не корректно валидирует эти данные и “склеивает” в итоговый SQL-запрос. Если не применять меры безопасности, атакующий может “внедрить” в запрос собственный код. Допустим, мы имеем неосторожный запрос к базе данных:

```
SELECT * FROM users WHERE username = 'ВВЕДЕННОЕ_ИМЯ' AND password = 'ВВЕДЕННЫЙ_ПАРОЛЬ';
```

Теперь представим, что злоумышленник вводит в поле имени пользователя строку вида ' OR '1'='1, а в пароле – что-то несущественное. Тогда итоговый запрос будет выглядеть примерно так:

```
SELECT * FROM users WHERE username = '' OR '1'='1' AND password = '12345';
```
Из-за части OR '1'='1' результатом будет бесконечно истинное утверждение, и система вполне может выдать данные обо всех пользователях или просто авторизовать атакующего.
Подобная уязвимость может привести к удалению таблиц.
В результате могут быть уничтожены все данные сайта.

## Command Injection
___

> При разработке веб-приложения может быть реализован функционал, позволяющий пользователю взаимодействовать с операционной системой веб-сервера. Для этого будет достаточно передать команду с дополнительными опциями в систему, а результат отображать на странице. Тем не менее, подобные возможности потенциально приводят к уязвимостям, которые возникают, если пользовательские данные в запросе к веб-приложению никак не фильтруются. Используя эту уязвимость, атакующий может получить чувствительные данные.

*    Файлы паролей операционной системы;

*    Конфигурационные файлы операционной системы;

*    Исходный код приложения.

**Пример использования:**
```commandline
<?php
        if (isset($_GET["ping"])) {
            echo '<pre>';
            $cmd = 'ping -c 10 ' . $_GET["ping"];
            passthru($cmd);
            echo '</pre>';
        }
?>
```
Пользовательский ввод принимается через GET-параметр ping и подставляется в соответствующую строку в качестве аргумента при выполнении команды операционной системы.

## SSRF (Server-Side Request Forgery)
___

> **SSRF (Server-Side Request Forgery, подделка серверных запросов)** — атака, при которой злоумышленник использует уязвимость веб-приложения, чтобы отправлять запросы от имени сервера.

![Графическое представление](https://github.com/Haoedon/practice-2025-1/blob/master/docs/images/img.png?raw=true)

SSRF позволяет не только добывать информацию, но и открывает возможности для проведения других атак. В примере ниже все закончилось компрометацией сервера.

При первоначальном исследовании веб-приложения мы обнаружили директорию /admin. Однако при обращении к ней получили ответ «403 Forbidden». По названию можно было предположить, что это некая административная панель, и поэтому к ней закрыт доступ для внешних пользователей.

Вроде бы все правильно: панель защищена. Но мы все-таки нашли в приложении возможность проведения SSRF-атаки, и административная панель оказалась доступна любому пользователю. Уязвимой была функциональность загрузки файлов по ссылке: при передаче адреса localhost/admin в ответе возвращалась интересующая нас страница.

![Запрос страницы admin с локального адреса](https://github.com/Haoedon/practice-2025-1/blob/master/docs/images/img.png?raw=true)

Анализ ответов показал, что это действительно административная панель с функциональностью управления приложением и пользователями. И она была доступна без аутентификации с локального адреса!

## XML External Entity
___

> XML External Entity (XXE) — это уязвимость веб-безопасности, которая возникает, когда приложение обрабатывает XML-ввод без надлежащей проверки или очистки. 

### Суть XXE-атаки

Стандарт XML предусматривает возможность использования DTD (document type definition). DTD даёт возможность определять и использовать XML-сущности. Сущности могут быть как полностью определены внутри документа (например, представлять собой какую-то строку), так и ссылаться на какой-то внешний ресурс. Отсюда и происходит название XXE-атаки: XML eXternal Entities.

Внешние сущности могут быть определены через URI, вследствие чего XML-парсер может обработать этот URI и подставить полученное содержимое в XML-документ.

Пример XML-документа, в котором определена внешняя сущность:

```
<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file://D:/XXETarget.txt">
]>
<foo>&xxe;</foo>
```
Здесь определена сущность '&xxe;'. При обработке этого XML-документа парсер подставит вместо '&xxe;' содержимое файла 'D:\XXETarget.txt'.

Таким образом, атака возможна, если:

* Злоумышленник может передать приложению XML-файл с внешними сущностями, и приложение выполнит парсинг этого файла;
* XML-парсер имеет небезопасную конфигурацию;
* Данные парсинга (значения сущностей) могут попасть обратно к злоумышленнику.


Как следствие, злоумышленник может получить доступ к содержимому файлов на скомпрометированном устройстве, выполняющем парсинг XML-файла. Кроме того, следствием атаки может стать подделка запросов на стороне сервера (SSRF).













